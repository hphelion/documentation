<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" ><topic xml:lang="en-us" id="topic10581">
<title>HP Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 1.1: Applying the Horizon Dynamic
    Password Patch</title>
<prolog>
  <metadata>
    <othermeta name="layout" content="default"/>
    <othermeta name="product-version" content="HP Helion Openstack Carreir Grade 1.1"/>
    <othermeta name="role" content="Storage Administrator"/>
    <othermeta name="role" content="Storage Architect"/>
    <othermeta name="role" content="Michael B"/>
    <othermeta name="product-version1" content="HP Helion Openstack Carreir Grade 1.1"/>
  </metadata>
</prolog>
<body>
    <p><!--Based on https://wiki.hpcloud.net/display/HCG/.Helion+CG+1.1+GA+Patch+Instructions--></p>
    <section>The HP Helion OpenStack cloud deployment creates a default password to log into the
      Horizon interface. <p>You can deploy a patch to configure the installer to generate a dynamic
        user name and password for the Horizon interface. The user name and password can be
        retrieved from a configuration file. You should have downloaded the patch files in the <xref
          href="carrier-grade-install-pb-prereqs-GA.dita#topic7148/getinstall"
        >Prerequisites</xref>.</p><p><b>Note:</b> You need the Ubuntu patch utility installed on the
        HLM host. If you do not have the utility installed, use the following
        command:</p><codeblock>apt-get install patch </codeblock><p>To apply the patch:</p><ol
        id="ol_dhy_1pj_dt">
        <li>Log into the HLM host.</li>
        <li>Copy the <codeph>horizon_web_patch_1.1.tar.gz</codeph> to the
            <codeph>~/patch_cghelion1.1</codeph> directory.
          <codeblock>cp horizon_web_patch_1.1.tar.gz ~/patch_cghelion1.1</codeblock></li>
        <li>Use the following command to extract the <codeph>horizon_web_patch_1.1.tar.gz</codeph>:
          <codeblock>tar -zxvf horizon_web_patch_1.1.tar.gz</codeblock></li>
      </ol></section>
      <section><title>Apply the patch to the Configuration Processor</title>
        <ol>
        <li>Change to the following directory:
          <codeblock>cd ~/kenobi-configuration-processor</codeblock></li>
        <li> Execute the following command to perform a dry-run of the patch to verify:
            <codeblock> patch -p1 --dry-run &lt; ~/patch_cghelion1.1/horizon_web_patch_1.1.patch </codeblock><p>The
            output appears similar to the
          following:</p><codeblock>checking file Data/Site/services/keystone.json</codeblock></li>
        <li> Execute the following command to apply the
            patch:<codeblock>patch -p1 &lt; ~/patch_cghelion1.1/horizon_web_patch_1.1.patch</codeblock><p>The
            output appears similar to the
          following:</p><codeblock>patching file Data/Site/services/keystone.json</codeblock></li>
        </ol></section>
  <section>
      <title>Synchronize the patch files to the environment</title>
      <ol>
        <li>Change to the <codeph>~/cg-hlm/hlm-build</codeph>
          folder:<codeblock>cd ~/cg-hlm/hlm-build</codeblock></li>
        <li>Execute the following command to synch the patch
          file:<codeblock>./hlm_prepare-env.sh</codeblock></li>
      </ol>
    </section>
  <section><!--<title>Configure roles in Ansible</title><p><b>Important:</b> If you are deploying this patch on an existing HP Helion OpenStack Carrier Grade environment, perform the following task. If not, you can skip to <xref href="#topic10581/password" format="dita">Retrieve the Horizon password</xref>.</p><p>The <codeph>deploy-CCP-T1.yml</codeph> file is a playbook used by Ansible. You need to edit this file to comment all the roles except <codeph>KEY-API</codeph>. <ol id="ol_zjc_tqw_dt"><li>Change to the directory where the <codeph>deploy-CCP-T1.yml</codeph> is located: <codeblock>cd ~/cloud/clouds/cloud/001/stage/ansible/deploy-CCP-T1.yml</codeblock></li><li>Edit the file to comment all the roles except <codeph>KEY-API</codeph>.</li><li>Execute the following command: <codeblock>ansible-playbook -i hosts deploy-CCP-T1.yml </codeblock></li></ol></p>--></section>
    <section id="password"><title>Retrieve the Horizon password</title>After the patch is implemented and the HP
      Helion OpenStack cloud is deployed, you and retrieve the random password from the
        <codeph>stackrc</codeph> file. <ol id="ol_pbh_mrw_dt">
        <li>SSH to any controller in the non-KVM region:
          <codeblock>ssh cghelion@&lt;ip-address></codeblock></li>
        <li>Change to the <codeph>/root/</codeph> directory: <codeblock>sudo -i</codeblock></li>
        <li>Open the <codeph>stackrc</codeph> file <codeblock>vi stackrc</codeblock></li>
        <li>Locate the <codeph>export OS_PASSWORD=</codeph> field. The value is the Horizon
          password. </li>
      </ol></section>
  <p>Return to the <xref href="carrier-grade-install-kvm.dita#topic10581/patch-after">KVM
        installation</xref>.</p>
    <p>Return to <xref href="carrier-grade-install-kvm-esx-GA.dita#topic10581/patch-after">the KVM +
        ESX installation</xref>.</p>
  </body>
</topic>
