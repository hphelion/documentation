<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic
  PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd" ><topic xml:lang="en-us" id="topic3042">
<title>HP Helion <tm tmtype="reg">OpenStack</tm> Carrier Grade 1.1: Setting Up User Data Using the CLI</title>
<prolog>
<metadata>
<othermeta name="layout" content="default"/>
<othermeta name="product-version" content="HP Helion Openstack"/>
<othermeta name="product-version" content="HP Helion Openstack 1.1"/>
<othermeta name="role" content="All"/>
<othermeta name="role" content="Paul F"/>
<othermeta name="product-version1" content="HP Helion Openstack"/>
<othermeta name="product-version2" content="HP Helion Openstack 1.1"/>
</metadata>
</prolog>
<body>
<p>
<!--UNDER REVISION-->
 <!--./CarrierGrade/DeploymentScenarios/carrier-grade-deployment-cli-data.md-->
 <!--permalink: /helion/openstack/carrier/deploy/cli/data/--></p>
<p>Using the CLI, you can save user data as a file for reference when launching an instance.</p>
<!-- ===================== horizontal rule ===================== -->
<p>
<b>Note:</b> This feature applies only to servers in the VNF Region.</p>
<!-- ===================== horizontal rule ===================== -->
<p>When launching an instance, you can provide user data containing configuration details. If you use the CLI, you can save the user data to a text file, and then supply the file name as a parameter.</p>
<p>The scenarios require four user data files: one for instances using the Linux kernel bridging facilities, one for instances using the DPDK-accelerated virtual switch, and two for instances using a Linux router. The user data specifies which function to implement, and includes any information required by the function, such as the ports to bridge or the IP subnets to route.</p>
<p>
<b>Caution:</b> The first line in the user data file is a mandatory comment. Without it, the user data is ignored, and all network interfaces are initialized using DHCP.</p>
<ol>
<li>Create a directory <codeph>/usr/share/userdata</codeph> for storing user data files.<p>The
                    following command creates the directory if does not already
                exist.</p><codeblock><codeph>/usr/share/userdata
</codeph></codeblock></li>
<li>Create a user data file for use with the Linux kernel bridging facilities.<p>Create a file
                        <codeph>/usr/share/userdata/linux-bridge.txt</codeph> with the following
                    content:</p><codeblock><codeph>#wrs-config
FUNCTIONS="bridge"
BRIDGE_PORTS="eth1,eth2.5"
</codeph></codeblock><p>The
                    BRIDGE_PORTS variable specifies the virtual machine ports to bridge:
                        <codeph>eth1</codeph> (the tenant network) and <codeph>eth2.5</codeph> (the
                    internal network on VLAN ID 5).</p></li>
<li>Create a user data file for use with the DPDK-accelerated virtual switch.<p>Create a file
                        <codeph>/usr/share/userdata/linux-dpdk-vswitch.txt</codeph> with the
                    following
                    content:</p><codeblock><codeph>#wrs-config
FUNCTIONS="hugepages,vswitch"
BRIDGE_PORTS="eth0,eth1.5"
</codeph></codeblock><p>Note
                    that in this case, the name of the Ethernet interfaces refers to ports in the
                    accelerated virtual switch, and not to ports in the virtual machine.</p></li>
<li>Create a user data file for use with the <codeph>tenant1</codeph> Linux router.<p>Create a file
                        <codeph>/usr/share/userdata/tenant1-linux-router.txt</codeph> with the
                    following
                content:</p><codeblock>
<codeph>#wrs-config
FUNCTIONS="routing"
ADDRESSES=(
    "172.31.1.1,255.255.255.0,eth1,1500"
    "10.1.1.1,255.255.255.0,eth2.5,1500"
    )
ROUTES=(
    "10.160.2.0/24,172.31.2.2,eth1"
    "10.170.2.0/24,10.1.1.2,eth2.5"
    )
</codeph>
</codeblock></li>
<li>Create a user data file for use with the <codeph>tenant2</codeph> Linux router.<p>Create a file
                    /usr/share/userdata/tenant2-linux-router.txt with the following
                    content:</p><codeblock><codeph>#wrs-config
FUNCTIONS="routing"
ADDRESSES=(
    "172.31.2.1,255.255.255.0,eth1,1500"
    "10.1.2.1,255.255.255.0,eth2.5,1500"
    )
ROUTES=(
    "10.170.2.0/24,172.31.2.2,eth1"
    "10.160.2.0/24,10.1.1.1,eth2.5"
    )
</codeph></codeblock><p>The
                    image user data files are available for use when launching instances.</p></li>
</ol>
<p>
  <xref type="section" href="#topic3042"> Return to Top </xref>
</p>
<!-- ===================== horizontal rule ===================== -->
</body>
</topic>
