
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
<head><meta name="description" content="Due to the single threading required in both cinder-volume and the drivers, the Cinder volume service is run as a singleton in the control plane. Prerequisite Helion OpenStack cloud must be ..."></meta><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><meta name="DC.Type" content="topic"></meta><meta name="DC.Title" content="HPE Helion OpenStack 2.0: Managing Cinder Volume and Backup Services"></meta><meta name="prodname" content="HPE Helion"></meta><meta name="version" content="4.1.0"></meta><meta name="copyright" content="HPE Helion 2015" type="primary"></meta><meta name="DC.Rights.Owner" content="HPE Helion 2015" type="primary"></meta><meta name="DC.Format" content="XHTML"></meta><meta name="DC.Identifier" content="topic_l1p_vpy_jt"></meta><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>HPE Helion OpenStack 2.0: Managing Cinder Volume and Backup Services</title><!--  Generated with Oxygen version 17.0, build number 2015072912.  --><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/skins/skin.css"><!----></link><script type="text/javascript"><!--
          
          var prefix = "../../index.html";
          
          --></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="topic_l1p_vpy_jt">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"></td><td><div class="navheader"></div></td></tr></tbody></table>

  <h1 class="title topictitle1">HPE Helion OpenStack<sup>Â®</sup> 2.0: Managing Cinder Volume and Backup Services</h1>

  <div class="body">
    <p class="p">Due to the single threading required in both <samp class="ph codeph">cinder-volume</samp> and the drivers,
      the Cinder volume service is run as a singleton in the control plane.</p>

    <div class="section"><h2 class="title sectiontitle">Prerequisite</h2>
      
      <p class="p">Helion OpenStack cloud must be successfully deployed. </p>

    </div>

    <div class="section"><h2 class="title sectiontitle">Migrating the Cinder Volume and Backup Services</h2>
      
      <div class="p">Due to the single threading required in both <samp class="ph codeph">cinder-volume</samp> and the
        drivers, and because Cinder backups have a dependency on <samp class="ph codeph">cinder-volume</samp>, the
        Cinder volume and backup services are started on one controller node at a time. By default,
        these services are started on the first node in the Cinder volume and backup hostgroup. If
        needed, the volume and backup services can be migrated to a different node in the hostgroup.
        The following steps describe how to migrate the services to a specified host.<ol class="ol" id="topic_l1p_vpy_jt__ol_mmx_mkb_kt">
          <li class="li">Get the hostname of the node Cinder volume and backup are to be migrated to. <div class="p">For
              example: <pre class="pre codeblock">$ hostname
padawan-ccp-c1-m2-mgmt</pre>
</div>
</li>

          <li class="li">Run the <samp class="ph codeph">cinder-migrate-volume.yml</samp> playbook specifying the node to
            migrate to in the <samp class="ph codeph">migrate_host</samp>
            argument:<pre class="pre codeblock">cd ~/scratch/ansible/next/hos/ansible 
ansible-playbook -i hosts/verb_hosts cinder-migrate-volume.yml --extra-vars "migrate_host=padawan-ccp-c1-m2-mgmt"</pre>
After
            successfully running the <samp class="ph codeph">cinder-migrate-volume.yml</samp> playbook, the Cinder
            volume and backup services should be running on the specified node. For example:
              <samp class="ph codeph">padawan-ccp-c1-m2-mgmt</samp>. <p class="p">If the original node where the services
              were running is restarted, the Cinder volume and backup services will not restart on
              this node. For example, they will not start on <samp class="ph codeph">
                padawan-ccp-c1-m1-mgmt</samp>. To get the Cinder volume and backup services
              running again on <samp class="ph codeph">padawan-ccp-c1-m1-mgmt</samp>, run the
                <samp class="ph codeph">cinder-migrate-volume.yml</samp> playbook again by setting the
                <samp class="ph codeph">migrate_host</samp> value to
            <samp class="ph codeph">padawan-ccp-c1-m1-mgmt</samp>.</p>
</li>

        </ol>
</div>

    </div>

    <div class="section"><h2 class="title sectiontitle">Managing Cinder Volume and Backup Services During a Node Reboot </h2>
      
      <div class="p">If the controller node is running Cinder volume and backup reboots, perform the following
        steps: <ol class="ol" id="topic_l1p_vpy_jt__ol_o3k_1ff_pt">
          <li class="li">Run the <samp class="ph codeph">hlm-start.yml</samp> playbook on the node that has just rebooted
            using the <samp class="ph codeph">--limit &lt;hostname&gt;</samp> option. <p class="p">For example:
            </p>
<pre class="pre codeblock"> cd ~/scratch/ansible/next/hos/ansible/
 ansible-playbook -i hosts/verb_hosts hlm-start.yml --limit padawan-ccp-c1-m1-mgmt </pre>
</li>

          <li class="li">Migrate the Cinder volume and backup services using the
              <samp class="ph codeph">cinder-migrate-volume.yml</samp> playbook.<p class="p">The node to migrate to may be
              the node that has just rebooted, or it can be one of the other nodes in the Cinder
              volume hostgroup. </p>
</li>

        </ol>
</div>

    </div>

    <div class="section"><h2 class="title sectiontitle">Managing Cinder Volume and Backup Services During a Node Replacement</h2>
      
      <div class="p">If the controller node running Cinder volume and backup is going to be replaced with a new
        node, perform the following steps: <ol class="ol" id="topic_l1p_vpy_jt__ol_b1c_ngf_pt">
          <li class="li">Migrate the Cinder volume and backup services to another controller node using the
              <samp class="ph codeph">cinder-migrate-volume.yml</samp> playbook.</li>

          <li class="li">For control plane nodes, follow the steps in <a class="xref" href="../operations/replace_controller.html#topic_ijj_45j_nt">HPE Helion OpenStack 2.0: Replacing a Controller Node</a>. </li>

          <li class="li">Run the <samp class="ph codeph">cinder-migrate-volume.yml</samp> playbook again to ensure the new
            node has an up-to-date view of the volume service location. <p class="p">When running
                <samp class="ph codeph">cinder-migrate-volume.yml</samp>, the volume service can optionally be
              migrated on to the new node or on to one of the other nodes in the Cinder volume
              hostgroup.</p>
</li>

        </ol>
</div>

    </div>

  </div>

<div class="navfooter"><!----></div><div class="footer">WebHelp output generated by<a class="oxyFooter" href="http://www.oxygenxml.com" target="_blank"><span class="oXygenLogo"><img src="../../oxygen-webhelp/resources/img/LogoOxygen100x22.png" alt="Oxygen"></img></span><span class="xmlauthor">XML Author</span></a></div>
</body>
</html>