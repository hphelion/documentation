
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
<head><meta name="description" content="In HPE Helion OpenStack 2.0, a local git repository is used to track configuration changes and the Configuration Processor (CP) uses this repository. The introduction of a git workflow also means that ..."></meta><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><meta name="DC.Type" content="topic"></meta><meta name="DC.Title" content="HPE Helion OpenStack 2.0: Using Git for Configuration Management"></meta><meta name="prodname" content="HPE Helion"></meta><meta name="version" content="4.1.0"></meta><meta name="copyright" content="HPE Helion 2015" type="primary"></meta><meta name="DC.Rights.Owner" content="HPE Helion 2015" type="primary"></meta><meta name="DC.Format" content="XHTML"></meta><meta name="DC.Identifier" content="using_git"></meta><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>HPE Helion OpenStack 2.0: Using Git for Configuration Management</title><!--  Generated with Oxygen version 17.0, build number 2015072912.  --><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/skins/skin.css"><!----></link><script type="text/javascript"><!--
          
          var prefix = "../../index.html";
          
          --></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="using_git">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"></td><td><div class="navheader"></div></td></tr></tbody></table>

  <h1 class="title topictitle1">HPE Helion OpenStack<sup>Â®</sup> 2.0: Using Git for Configuration
    Management</h1>

  <div class="body">
    <p class="p">In HPE Helion OpenStack 2.0, a local git repository is used to track configuration changes and
      the Configuration Processor (CP) uses this repository. The introduction of a git
      workflow also means that your configuration history is maintained, making rollbacks easier as
      well as keeping a record of previous configuration settings.</p>

    <p class="p">The git repository is installed by the deployer on the deployer node.</p>


    
    <p class="p">The git repository provides a way for you to merge changes that you pull down as "upstream" (i.e. from HP)
      updates, and allows you to manage your own configuration changes. </p>

    <div class="section"><h2 class="title sectiontitle">Initialization on a new deployment</h2>
      
      <p class="p">On a system new to HPE Helion OpenStack 2.0, the deployer will prepare a git repository
        under <samp class="ph codeph">~/helion</samp>. The deployer provisioning runs the <samp class="ph codeph">hlm-init-deployer</samp> script automatically -
        this calls <samp class="ph codeph">ansible-playbook -i hosts/localhost git-00-initialise.yml</samp>.</p>

      <div class="p">As a result, the <samp class="ph codeph">~/helion</samp> directory is initialized as a git repo (if it's empty). It is
        initialized with four empty branches: <dl class="dl">
          
            <dt class="dt dlterm">hos</dt>

            <dd class="dd">This holds the upstream  source code corresponding to the contents of
              the <samp class="ph codeph">~/helion</samp> directory on a pristine fresh installation. Every source code release
              that is downloaded from HPE is applied as a fresh commit to this branch. This branch
              contains no customization by the end user.</dd>

          
          
            <dt class="dt dlterm">site</dt>

            <dd class="dd">This branch begins life as a copy of the first 'hos' drop. It is onto this branch
              that you commit your configuration changes. It's the branch most visible to the end
              user.</dd>

          
          
            <dt class="dt dlterm">ansible</dt>

            <dd class="dd">This branch contains the variable definitions generated by the CP that our main
              ansible playbooks need. This includes the <samp class="ph codeph">verb_hosts</samp> file that describes to ansible what servers
              are playing what roles. The <samp class="ph codeph">ready-deployment</samp> playbook takes this
              output and assembles a <samp class="ph codeph">~/scratch</samp> directory containing the ansible playbooks together
              with the variable definitions in this branch. The result is a working ansible
              directory <samp class="ph codeph">~/scratch/ansible/next/hos/ansible</samp> from which the main deployment playbooks may be successfully run. </dd>

          
          
            <dt class="dt dlterm">cp-persistent</dt>

            <dd class="dd">This branch contains the persistent state that the CP needs to maintain. That
              state is mostly the assignment of IP addresses and roles to particular servers. Some
              operational procedures may involve editing the contents of this branch: for example,
              retiring a machine from service or repurposing it.</dd>

          
        </dl>
Two temporary branches are created and populated at run time: <dl class="dl">
          
            <dt class="dt dlterm">staging-ansible</dt>

            <dd class="dd">This branch hosts the most recent commit that will be appended to the ansible
              branch.</dd>

          
          
            <dt class="dt dlterm">staging-cp-persistent</dt>

            <dd class="dd">This branch hosts the most recent commit that will be appended to the cp-persistent
              branch.</dd>

          
        </dl>

        <div class="note note"><span class="notetitle">Note:</span> The information above provides insight into the workings of the configuration
          processor and the git repository. However, in practice you can simply follow the steps
          below to make configuration changes.</div>

      </div>

    </div>

    
    <div class="section" id="using_git__updating-configuration-including-default-config"><h2 class="title sectiontitle">Updating any configuration, including the default configuration</h2>
      
      <div class="p">When you need to make updates to a configuration you must <ol class="ol">
          <li class="li">Check out the <strong class="ph b">site</strong> branch. You may already be on that branch. If so, git will
            tell you that and the command will leave you
            there.<pre class="pre codeblock">git checkout site</pre>

          </li>

          <li class="li">Edit the YAML file or files that contain the configuration you want to change. </li>

          <li class="li">Commit the changes to the <strong class="ph b">site</strong> branch.
            <pre class="pre codeblock">git add -A
git commit -m "your commit message goes here in quotes"</pre>

          </li>

          <li class="li"> Run the configuration
            processor:<pre class="pre codeblock">cd ~/helion/hos/ansible
ansible-playbook -i hosts/localhost config-processor-run.yml
</pre>

            to produce the required configuration processor output from those changes. Review the
            output files manually if required.</li>

          <li class="li">Ready the deployment area
            <pre class="pre codeblock">ansible-playbook -i hosts/localhost ready-deployment.yml</pre>
</li>

          <li class="li">Run the deployment playbooks from the resulting scratch directory.
            <pre class="pre codeblock">cd ~/scratch/ansible/next/hos/ansible
ansible-playbook -i hosts/verb_hosts site.yml
</pre>

          </li>

        </ol>

      </div>

    </div>

  </div>

<div class="navfooter"><!----></div><div class="footer">WebHelp output generated by<a class="oxyFooter" href="http://www.oxygenxml.com" target="_blank"><span class="oXygenLogo"><img src="../../oxygen-webhelp/resources/img/LogoOxygen100x22.png" alt="Oxygen"></img></span><span class="xmlauthor">XML Author</span></a></div>
</body>
</html>