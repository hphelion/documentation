
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
<head><meta name="description" content="Important: Moonshots are supported as compute nodes. HPE Moonshot Servers are designed and tailored for specific workloads to deliver optimum performance. These support a wide range of complex IT ..."></meta><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><meta name="DC.Type" content="topic"></meta><meta name="DC.Title" content="HPE Helion OpenStack 2.0: Adding Moonshot Nodes"></meta><meta name="prodname" content="HPE Helion"></meta><meta name="version" content="4.1.0"></meta><meta name="copyright" content="HPE Helion 2015" type="primary"></meta><meta name="DC.Rights.Owner" content="HPE Helion 2015" type="primary"></meta><meta name="DC.Format" content="XHTML"></meta><meta name="DC.Identifier" content="topic_h3s_n4t_mt"></meta><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>HPE Helion OpenStack 2.0: Adding Moonshot Nodes</title><!--  Generated with Oxygen version 17.0, build number 2015072912.  --><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="../../oxygen-webhelp/resources/skins/skin.css"><!----></link><script type="text/javascript"><!--
          
          var prefix = "../../index.html";
          
          --></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="../../oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="../../oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="topic_h3s_n4t_mt">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"></td><td><div class="navheader"></div></td></tr></tbody></table>

  <h1 class="title topictitle1">HPE Helion OpenStack<sup>®</sup> 2.0: Adding Moonshot Nodes</h1>

  <div class="body">
    
    <div class="p">
      <div class="note important"><span class="importanttitle">Important:</span> Moonshots are supported as compute nodes.</div>

    </div>

    <p class="p">HPE Moonshot Servers are designed and tailored for specific workloads to deliver optimum
      performance. These support a wide range of complex IT demands right from cloud based
      applications to Social Media, Big Data and Mobility. HPE Moonshot Server is the world’s first
      software defined web server that will accelerate innovation while delivering breakthrough
      efficiency and scale.</p>

    <div class="section"><h2 class="title sectiontitle">Supported Moonshot Servers</h2>
      
    </div>

    <div class="p">The HPE Moonshot Servers are now verified hardware to run HPE Helion OpenStack. The supported
      Moonshot Servers are :<ul class="ul" id="topic_h3s_n4t_mt__ul_m44_rpt_mt">
        <li class="li">HPE ProLiant m710 Server Cartridge</li>

        <li class="li">HPE ProLiant m300 Server Cartridge</li>

      </ul>
</div>

    <div class="section"><h2 class="title sectiontitle">Configure Moonshot Nodes</h2>
      
      <div class="p">To configure Moonshot Nodes, you must add the Moonshot node's configuration details in the
        following YAML files:<ul class="ul" id="topic_h3s_n4t_mt__ul_vyc_fm1_nt">
          <li class="li"><samp class="ph codeph">control_plane.yml</samp></li>

          <li class="li"><samp class="ph codeph">disks_compute.yml</samp></li>

          <li class="li"><samp class="ph codeph">net_interfaces.yml</samp></li>

          <li class="li"><samp class="ph codeph">servers.yml</samp></li>

          <li class="li"><samp class="ph codeph">server_roles.yml</samp></li>

        </ul>
</div>

      <p class="p">When using the automated os-install mechanism, for each Moonshot Nodes you must provide the
        iLO information which is shared across Moonshot and a Moonshot identifier as an additional
        field.</p>

    </div>

    <div class="section"><h2 class="title sectiontitle">Moonshot iLOs </h2>
      
      <p class="p">All Moonshot nodes in a given enclosure have the same iLO IP address. To identify the
        specific node in the enclosure you need to add a "moonshot:" field in
          <samp class="ph codeph">servers.yml</samp> using the standard <strong class="ph b">c&lt;cartridge&gt;n&lt;node&gt;</strong> moonshot
        node identifiers.</p>

      <div class="p">For
        example:<pre class="pre codeblock">  - id: ccn-0001
      ip-addr: 10.1.12.34
      role: ROLE-CCP
      ilo-ip: 10.1.17.112
      ilo-password: whatever
      ilo-user: whatever
      moonshot: c4n2</pre>
</div>

    </div>

    <div class="section"><div class="sectiondiv"><strong class="ph b">YAML Files</strong></div><div class="p">Ensure that you modify the following YAML
        files before provisioning Moonshot nodes:<ul class="ul" id="topic_h3s_n4t_mt__ul_qbb_ln1_nt">
          
          <li class="li"><samp class="ph codeph">control_plane.yml</samp><div class="p">A control plane uses a server with a particular
              server-role. A sample file of <samp class="ph codeph">control_plane.yml</samp> is shown
              below:<pre class="pre codeblock">---
  product:
    version: 2

resource-nodes:
    - name: <strong class="ph b">moonshot</strong>
    resource-prefix: moon
    server-role: <strong class="ph b">ROLE-COMPUTE-MOONSHOT</strong>
    service-components:
       - ntp-client
       - nova-kvm
       - nova-compute
       - neutron-l3-agent
       - neutron-metadata-agent
       - neutron-openvswitch-agent
       - neutron-lbaasv2-agent</pre>
</div>
<p class="p">In
              the sample file, <strong class="ph b">server-role: ROLE-COMPUTE-MOONSHOT</strong> identifies the role of the
              Moonshot node.</p>
</li>

        </ul>
</div>
</div>

    <div class="section">
      <ul class="ul" id="topic_h3s_n4t_mt__ul_n51_lp1_nt">
        <li class="li"><samp class="ph codeph">disks_compute.yml</samp><div class="note note"><span class="notetitle">Note:</span>  The minimum size of the root device used in the
            input model is 32GB. You can increase the % value so that the size is greater than 32GB.
            This is a generic requirement but is specifically relevant to moonshots since the disk
            is relatively small. </div>
<div class="p">A disk model defines how local storage is to be
            configured and presented to services. Disk models are identified by a name, which can be
            specified by the user.
              
            A sample file of <samp class="ph codeph">disks_compute.yml</samp> is shown
            below:<pre class="pre codeblock">---
  product:
    version: 2

  disk-models:
  - name: <strong class="ph b">DISK_SET_COMPUTE_MOONSHOT</strong>
    # Disk model to be used for moonshot compute nodes
    # /dev/sda_root is used as a volume group for /, /var/log and /var/crash
    # sda_root is a templated value to align with whatever partition is really used
    # This value is checked in os config and replaced by the partition actually used
    # on sda e.g. sda1 or sda5
    # /dev/sdb is used as a volume group for /var/lib (for VM storage)
    # Additional discs can be added to either volume group
    volume-groups:
    # The policy is not to consume 100% of the space of each volume group.
    # 5% should be left free for snapshots and to allow for some flexibility.
      - name: hlm-vg
        physical-volumes:
         - /dev/sda_root
        logical-volumes:
          - name: root
            size: 35%
            fstype: ext4
            mount: /
          - name: log
            size: 10%
            mount: /var/log
            fstype: ext4
            mkfs-opts: -O large_file
          - name: crash
            size: 5%
            mount: /var/crash
            fstype: ext4
            mkfs-opts: -O large_file
          - name: compute
            size: 45%
            mount: /var/lib/nova
            fstype: ext4
            mkfs-opts: -O large_file</pre>
</div>
<p class="p">In
            the sample file, the name of the disk model is
          <strong class="ph b">DISK_SET_COMPUTE_MOONSHOT</strong>.</p>
</li>

        <li class="li"><samp class="ph codeph">net_interfaces.yml</samp><div class="p">The interface model describes how its network
            interfaces are to be configured and used.  A
            sample file of <samp class="ph codeph">net_interfaces.yml</samp> is shown
            below:<pre class="pre codeblock">---
  product:
    version: 2

  interface-models:
      # These examples uses eth3 and eth4 as a bonded
      # pair for all networks on all three server roles
      #
      # Edit the device names and bond options
      # to match your environment
      #
    
    - name: <strong class="ph b">INTERFACE_SET_COMPUTE_MOONSHOT</strong>
      network-interfaces:
        - name: eth1
          device:
              name: eth1
          network-groups:
            - EXTERNAL_VM
            - GUEST
            - MGMT</pre>
</div>
<p class="p">In
            the sample file, the name of the interface model is
                <strong class="ph b"><strong class="ph b">INTERFACE_SET_COMPUTE_MOONSHOT</strong></strong>.</p>
</li>

        <li class="li"><samp class="ph codeph">servers.yml</samp><div class="p">Servers list the available servers used for deploying the
            cloud. A sample file of <samp class="ph codeph">servers.yml</samp> is shown
            below:<pre class="pre codeblock">---
  product:
    version: 2

  servers:
    # NOTE: Addresses of servers need to be
    #       changed to match your environment.
    #
    #       Add additional servers as required
    #
    #       nic-mapping is optional.  The value specified is the name
    #       of an entry in the nic-mappings list from nic_mappings.yml.
    #       To use, uncomment and modify to match your environment.

    
    # Compute Nodes
    - id: compute6
      ip-addr: 192.168.60.21
      role: <strong class="ph b">ROLE-COMPUTE-MOONSHOT</strong>
    # nic-mapping: MY_2PORT_SERVER</pre>
</div>
<p class="p">In
            the sample file, <strong class="ph b">role: ROLE-COMPUTE-MOONSHOT</strong> identifies the role of the Moonshot
            node.</p>
<div class="p">Moonshot server comes with only 2 NICs. One is used for PXE and another is
            used as truck 9. <div class="note important"><span class="importanttitle">Important:</span> NIC binding is not supported due to limited
              number of NICs. Hence, the NIC mapping section in the HPE Helion OpenStack input model
              should not be present for moonshot nodes.</div>
</div>
</li>

        <li class="li"><samp class="ph codeph">server_roles.yml</samp><div class="p">You specify the usage of the server or where you
            want to use a particular server. A sample file of <samp class="ph codeph">server_roles.yml</samp> is
            shown
            below:<pre class="pre codeblock">---
  product:
    version: 2

  server-roles:
    
    - name: ROLE-COMPUTE-MOONSHOT
      interface-model: INTERFACE_SET_COMPUTE_MOONSHOT
      disk-model: DISK_SET_COMPUTE_MOONSHOT</pre>
</div>
<p class="p">Once
            you have modified the YAML files as per the moonshot node requirement, you can proceed
            with the installation. Refer to the <a class="xref" href="../installation/install_entryscale_kvm.html#install_kvm">installation
              guide</a> for more details.</p>
</li>

      </ul>

      <p class="p"> </p>

    </div>

  </div>

<div class="navfooter"><!----></div><div class="footer">WebHelp output generated by<a class="oxyFooter" href="http://www.oxygenxml.com" target="_blank"><span class="oXygenLogo"><img src="../../oxygen-webhelp/resources/img/LogoOxygen100x22.png" alt="Oxygen"></img></span><span class="xmlauthor">XML Author</span></a></div>
</body>
</html>